id: harmonia_time_pk_est
label: Time Peak Estimation
category: '[harmonia]'

parameters:
- id: samp_rate
  label: Sample Rate
  dtype: float
  default: "samp_rate"
- id: bandwidth
  label: Bandwidth
  dtype: float
  default: "bw"
- id: pulse_width
  label: Pulse Width
  dtype: float
  default: "Tp"
- id: wait_time
  label: Wait Time
  dtype: float
  default: "Tw"
- id: sample_delay
  label: Samples to Delay
  dtype: float
  default: "82"
- id: NLLS_iter
  label: NLLS Iterations
  dtype: float
  default: "15"
- id: sdr_id
  label: Platform Number
  dtype: int
  default: "1"
- id: backend
  label: Backend
  dtype: enum
  options: [harmonia.Device.DEFAULT, harmonia.Device.CPU, harmonia.Device.CUDA, harmonia.Device.OPENCL]
  option_labels: [Default, CPU, Cuda, OpenCL]
- id: depth
  label: Message Queue Depth
  dtype: int
  default: 1
  hide: part

inputs:
- id: tx
  domain: message
- id: rx
  domain: message

outputs:
- id: tp_out
  domain: message
- id: out
  domain: message

templates:
  imports: from gnuradio import harmonia
  make: |-
    harmonia.time_pk_est(${samp_rate}, ${bandwidth}, ${pulse_width}, ${wait_time}, ${sample_delay}, ${NLLS_iter}, ${sdr_id})
    self.${id}.set_msg_queue_depth(${depth})
    self.${id}.set_backend(${backend})


#  'file_format' specifies the version of the GRC yml format used in the file
#  and should usually not be changed.
file_format: 1
