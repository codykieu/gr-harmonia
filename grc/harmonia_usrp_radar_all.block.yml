id: harmonia_usrp_radar_all
label: UHD:All USRP Radars
category: '[harmonia]'

parameters:
  - id: args_1
    label: SDR 1 Device Arguments
    dtype: string
    default: '""'
    hide: ${ ('part' if args_1 == "" else 'none') }
  - id: args_2
    label: SDR 2 Device Arguments
    dtype: string
    default: '""'
    hide: ${ ('part' if args_2 == "" else 'none') }    
  - id: args_3
    label: SDR 3 Device Arguments
    dtype: string
    default: '""'
    hide: ${ ('part' if args_3 == "" else 'none') }  
  - id: samp_rate
    label: Sample Rate (Hz)
    dtype: float
    default: "samp_rate"
  - id: sdr1_freq
    label: SDR 1 Frequency (Hz)
    dtype: float
    default: "center_freq"
  - id: sdr2_freq
    label: SDR 2 Frequency (Hz)
    dtype: float
    default: "center_freq"
  - id: sdr3_freq
    label: SDR 3 Frequency (Hz)
    dtype: float
    default: "center_freq"
  - id: sdr1_gain
    label: SDR 1 Gain (dB)
    dtype: float
    default: 0
  - id: sdr2_gain
    label: SDR 2 Gain (dB)
    dtype: float
    default: 0
  - id: sdr3_gain
    label: SDR 3 Gain (dB)
    dtype: float
    default: 0
  - id: start_delay
    label: Start Delay (s)
    dtype: float
    default: 0.1
  - id: cap_length
    label: Capture Time (s)
    dtype: float
    default: 0.1
  - id: wait_time
    label: Wait Time (s)
    dtype: float
    default: 2e-6
  - id: TDMA_time
    label: TDMA Time (s)
    dtype: float
    default: 2e-6
  - id: verbose
    label: Verbose
    dtype: bool
    options: [False, True]
    default: False
    hide: part
  # Metadata keys
  - id: sdr1_freq_key
    label: SDR 1 frequency key
    dtype: string
    default: core:tx_freq
    hide: part
    category: Metadata
  - id: sdr2_freq_key
    label: SDR 2 frequency key
    dtype: string
    default: core:rx_freq
    hide: part
    category: Metadata
  - id: sample_start_key
    label: Sample start key
    dtype: string
    default: core:sample_start
    hide: part
    category: Metadata
  - id: prf_key
    label: PRF key
    dtype: string
    default: radar:prf
    hide: part
    category: Metadata

inputs:
  - id: in
    domain: message
    optional: true
  - id: in2
    domain: message
    optional: true
  - id: in3
    domain: message
    optional: true
  - id: LFM_in
    domain: message
    optional: true
  - id: LFM_in2
    domain: message
    optional: true
  - id: LFM_in3
    domain: message
    optional: true
outputs:
  - id: out
    domain: message
    optional: true
  - id: out2
    domain: message
    optional: true
  - id: out3
    domain: message
    optional: true
  - id: cd_out
    domain: message
    optional: true
  - id: cd_out2
    domain: message
    optional: true
  - id: cd_out3
    domain: message
    optional: true
  - id: cb_out
    domain: message
    optional: true
  - id: cb_out2
    domain: message
    optional: true
  - id: cb_out3
    domain: message
    optional: true
    
templates:
  imports: from gnuradio import harmonia
  make: |-
    harmonia.usrp_radar_all(${args_1}, ${args_2}, ${args_3}, ${samp_rate}, ${samp_rate}, ${samp_rate}, ${sdr1_freq}, ${sdr2_freq}, ${sdr3_freq}, ${sdr1_gain},
     ${sdr2_gain}, ${sdr3_gain}, ${start_delay}, ${cap_length}, ${wait_time}, ${TDMA_time}, ${verbose})
    self.${id}.set_metadata_keys(${sdr1_freq_key}, ${sdr2_freq_key}, ${sample_start_key}, ${prf_key})

#  'file_format' specifies the version of the GRC yml format used in the file
#  and should usually not be changed.
file_format: 1
